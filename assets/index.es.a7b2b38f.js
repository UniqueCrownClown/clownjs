class O{constructor({el:t,options:e}){t instanceof HTMLElement?this.el=t:this.el=document.querySelector(t),this.options=Object.assign({immediate:!1,direction:["right"],scrollElSelector:null,lineColor:"#aab",lineWidth:2,lineHoverColor:"#88f",lineHoverWidth:4,tipLineColor:"#262626",tipLineWidth:1,tipLineStyle:"dashed",zIndex:999,needParentNodeOffset:!0},e),this.directionArr=this.options.direction||["right"],this.el.$resize=this}init(){const{position:t}=getComputedStyle(this.el),{position:e}=getComputedStyle(this.el.parentNode);t==="static"&&(this.el.style.position="relative"),e==="static"&&console.warn("[@clownjs/resize] Element parentNode position can not be static!"),this.directionArr.map(o=>{if(this.options.immediate){const i=this.createLineEl(o);this.el.appendChild(i)}else{const i=this.createDashedLineEl(o),n=this.createLineEl(o,i);this.el.appendChild(i),this.el.appendChild(n)}})}createDashedLineEl(t){const{tipLineColor:e,tipLineWidth:o,tipLineStyle:i,zIndex:n}=this.options,d=document.createElement("div"),f=`position:absolute;z-index: ${n};visibility: hidden;`,g=t==="left"||t==="right";return d.style.cssText=g?`${f};top:0;bottom: 0;${t}:0;border-${t}:${o}px ${i} ${e}`:`${f};left:0;right: 0;${t}:0;border-${t}:${o}px ${i} ${e}`,d.setAttribute("class","resize__dashed-line"),d}createLineEl(t,e){const{immediate:o,lineColor:i,lineWidth:n,lineHoverColor:d,lineHoverWidth:f,zIndex:g}=this.options,s=document.createElement("div"),x=`position: absolute;background: ${i};z-index: ${g}`,l=t==="left"||t==="right",p=t==="right"||t==="bottom";s.style.cssText=l?`${x};width: ${n}px;top:0;bottom: 0;${t}: -${n/2}px;cursor: col-resize;`:`${x};height: ${n}px;left:0;right: 0;${t}: -${n/2}px;cursor: row-resize;`,s.mouseoverEvent=function(){s.style.background=d,s.style[l?"width":"height"]=`${f}px`,s.style[t]=`-${f/2}px`},s.mouseoutEvent=function(){s.style.background=i,s.style[l?"width":"height"]=`${n}px`,s.style[t]=`-${n/2}px`};const c=this.el;return s.mousedownEvent=function(w){const L=(c||w.target.parentNode).parentNode;let u;const b=l?L.offsetWidth:L.offsetHeight;document.body.style.userSelect="none";let E=!0;const C=()=>{const m=l?c.offsetWidth:c.offsetHeight,v=l?c.offsetLeft:c.offsetTop,z=p?v+m+u:v+u,h=p?m+u:m-u,a=document.createEvent("HTMLEvents");a.initEvent("resize",!1,!1),a.direction=t,a.moveOffset=z,a.moveOffsetPercent=z/b*100,a[l?"resizeWidth":"resizeHeight"]=h,a[l?"resizeWidthPercent":"resizeHeightPercent"]=h/b*100,c.dispatchEvent(a)};document.onmousemove=function(m){m.preventDefault();const{x:v,y:z}=c.getBoundingClientRect(),h=l?c.offsetWidth:c.offsetHeight,a=l?c.offsetLeft:c.offsetTop;u=p?l?m.clientX-v-h:m.clientY-z-h:l?m.clientX-v:m.clientY-z,E=p?-u<=h&&a+h+u<=b:u<=h&&a+u>=0,E&&(o?C():e&&(e.style.visibility="visible",e.style[t]=`${p?-u:u}px`))},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,document.body.style.userSelect="auto",o||(e&&(e.style.visibility="hidden"),E&&(C(),e&&(e.style[t]="0px")))}},s.setAttribute("class","resize__line"),s.addEventListener("mousemove",s.mouseoverEvent),s.addEventListener("mouseout",s.mouseoutEvent),s.addEventListener("mousedown",s.mousedownEvent),s}destroy(){Array.prototype.slice.call(this.el.querySelectorAll(".resize__line")).forEach(e=>{e.mouseoverEvent&&e.removeEventListener("mousemove",e.mouseoverEvent),e.mouseoutEvent&&e.removeEventListener("mouseout",e.mouseoutEvent),e.mousedownEvent&&e.removeEventListener("mousedown",e.mousedownEvent),e.parentNode&&e.parentNode.removeChild(e)}),this.el.querySelectorAll(".resize__dashed-line").forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})}}const y=(r,t,e)=>{const{arg:o,value:i}=t,n=e||{};let d,f;o&&(o==="all"?d=["top","left","bottom","right"]:d=[o]),d?f=Object.assign(Object.assign(Object.assign({},n),i),{direction:d}):f=Object.assign(Object.assign({},n),i),new O({el:r,options:f}).init()},$=r=>{r.$resize&&r.$resize.destroy()},H={mounted:(r,t)=>y(r,t),unmounted:$,inserted:(r,t)=>y(r,t),unbind:$,install:(r,t)=>{r.directive("resize",{mounted:(e,o)=>y(e,o,t),unmounted:$,inserted:(e,o)=>y(e,o,t),unbind:$})}};export{H as R};
