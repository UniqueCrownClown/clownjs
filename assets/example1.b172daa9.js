import{_ as o,d as h,b as c,z as p,o as l,g as a,t as f}from"./index.4270ec1d.js";class d{constructor(t,s,i,u){y(t),b(t),this.obj=t,this.input=typeof s=="string"?[s]:s,this.fn=typeof i=="function"?i:function(){},this.hooks=typeof u=="function"?u:function(){},this.timer=0,this.typeAction={rollback:this.typedBack.bind(this),normal:this.play.bind(this),custom:this.fn},this.init()}init(){this.play()}play(){if(!this.input.length)return this.fn(this);let t=0,s=!1,i=this.input.shift()||"";this.timer=setInterval(()=>{if(t===i.length&&(t=0,s=!0,this.closeTimer()),this.obj.isEnd)return this.closeTimer();if(s)return this.nextTick();this.obj.output=i.slice(0,t+1),this.hooks(i.slice(0,t+1),this),t++},this.obj.speed)}typedBack(){if(!this.input.length&&this.obj.sentencePause)return this.fn(this);let t=this.obj.output,s=t.length,i=!1;this.timer=setInterval(()=>{if(s===-1&&(this.obj.output="",this.hooks("",this),s=0,i=!0,this.closeTimer()),this.obj.isEnd)return this.closeTimer(),this.obj.singleBack=!1;if(i)return this.obj.singleBack=!1,(()=>{const{length:u}=this.input;return u?this.play():this.fn(this)})();this.obj.output=t.slice(0,s+1),this.hooks(t.slice(0,s+1),this),s--},this.obj.backSpeed)}async nextTick(){return await this.sleep(this.obj.sleep),this.obj.singleBack?this.typedBack():this.getOutputType()}getOutputType(){return this.typeAction[this.obj.type](this)}closeTimer(){clearInterval(this.timer)}sleep(t){return new Promise(s=>setTimeout(s,t))}close(){return this.obj.isEnd=!0}}const r=e=>{throw new Error(e)},y=e=>{const s=Object.keys({output:"",type:"",isEnd:!1,speed:80,backSpeed:40,sleep:3e3,singleBack:!1,sentencePause:!1}),i=Object.keys(e);s.length!==i.length&&r("\u914D\u7F6E\u5BF9\u8C61\u9519\u8BEF: \u5B57\u6BB5\u6570\u91CF\u4E0D\u6B63\u786E\uFF01"),s.forEach(u=>{(e[u]===void 0||e[u]===null)&&r("\u914D\u7F6E\u5BF9\u8C61\u9519\u8BEF\uFF1A\u5B57\u6BB5\u503C\u4E3Anull\u6216undefined\uFF01")})},b=e=>{Object.keys(e).forEach(t=>{const s=E[t](e);s.check()&&s.showTip(t)})},E=(()=>({output:e=>new n("string",e.output),type:e=>new n("string",e.type),isEnd:e=>new n("boolean",e.isEnd),speed:e=>new n("number",e.speed),backSpeed:e=>new n("number",e.backSpeed),sleep:e=>new n("number",e.sleep),singleBack:e=>new n("boolean",e.singleBack),sentencePause:e=>new n("boolean",e.sentencePause)}))();class n{constructor(t,s){this.type=t,this.field=s}check(){return typeof this.field!=`${this.type}`}showTip(t){r(`\u914D\u7F6E\u5BF9\u8C61\u9519\u8BEF\uFF1A\u5C5E\u6027 ${t} \u5FC5\u987B\u4E3A ${this.type} \u7C7B\u578B\uFF01`)}}const B=h({setup(){const e=c({output:"",isEnd:!1,speed:100,singleBack:!0,sleep:10,type:"normal",backSpeed:40,sentencePause:!0});return p(()=>{new d(e,"\u843D\u971E\u4E0E\u5B64\u9E5C\u9F50\u98DE\uFF0C\u79CB\u6C34\u5171\u957F\u5929\u4E00\u8272\u3002")}),{obj:e}}});function k(e,t,s,i,u,F){return l(),a("div",null,f(e.obj.output),1)}var g=o(B,[["render",k]]);export{g as default};
