import{d as J,w as M,r as v,o as u,g as O,F as N,k as $,a as T,K as Y,e as H,c as h,y,L as E,m as D,l as _,J as z,t as L,M as G,i as W,N as K,E as P,_ as Q,z as X}from"./index.f1855672.js";const Z={class:"single-line-form",style:{display:"inline-block",width:"100%"}};var F=J({__name:"lineForm",props:{type:{type:String,required:!0,default:"input"},label:{type:String,required:!0,default:""},disabled:{type:Boolean,required:!0,default:!1},modelValue:{type:null,required:!0,default:""},renderData:{type:null,required:!0,default:()=>({multiple:!1,options:[{label:"hello",value:"world"}]})},detailVal:{type:null,required:!0,default:()=>({value:""})}},emits:["change","selectChange"],setup(a,{emit:c}){const s=a,d=T();let p={};Y(()=>{s.renderData.multiple&&(p=s.detailVal.value),Array.isArray(s.modelValue)?(d.value=s.modelValue,s.modelValue.length>0&&c("selectChange",s.modelValue,s.renderData,s.detailVal,p)):(d.value=s.modelValue.toString(),s.type==="select"&&c("selectChange",s.modelValue,s.renderData))});const x=b=>{var m;if(!((m=s.renderData)===null||m===void 0)&&m.multiple){c("selectChange",b,s.renderData,s.detailVal,p);return}c("selectChange",b,s.renderData)},V=H(()=>{var b;return((b=s.renderData)===null||b===void 0?void 0:b.disabled)||s.disabled});return M(d,b=>{c("change",b)}),(b,m)=>{const R=v("el-option"),j=v("el-select"),l=v("el-switch"),t=v("el-input");return u(),O("div",Z,[a.type==="select"?(u(),h(j,{key:0,modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=e=>d.value=e),label:a.label,disabled:E(V),multiple:a.renderData.multiple||!1,placeholder:"\u8BF7\u9009\u62E9",onChange:x},{default:y(()=>[(u(!0),O(N,null,$(a.renderData.options,e=>(u(),h(R,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","label","disabled","multiple"])):a.type==="switch"?(u(),h(l,{key:1,modelValue:d.value,"onUpdate:modelValue":m[1]||(m[1]=e=>d.value=e),label:a.label,disabled:E(V),"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"true","inactive-value":"false"},null,8,["modelValue","label","disabled"])):(u(),h(t,{key:2,modelValue:d.value,"onUpdate:modelValue":m[2]||(m[2]=e=>d.value=e),label:a.label,disabled:E(V),placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue","label","disabled"]))])}}});F.__file="packages/yaml-edit/src/lineForm.vue";const ee={class:"yamlEdit"},te={style:{padding:"10px",position:"relative"}},le={style:{padding:"10px",position:"relative"}},ne={name:"yamlEdit"};var C=J(Object.assign(Object.assign({},ne),{props:{renderData:{type:null,required:!0,default:()=>({test:"2"})},isEdit:{type:Boolean,required:!0,default:()=>!0},labelWidth:{type:String,required:!0,default:()=>"100px"}},emits:["update:renderData"],setup(a,{expose:c,emit:s}){const d=a;let p={};const x=(l,t)=>{const e=(o,i)=>{const q=Object.entries(o).reduce((n,r)=>{var g,w,A;if(r[1].children&&i[r[0]]){if(r[1].isArray&&((g=i[r[0]])===null||g===void 0?void 0:g.length)>0){const B=i[r[0]].map(U=>e(r[1].children,U));return[...n,[r[0],Object.assign(Object.assign({},r[1]),{value:B})]]}if(!((A=(w=r[1])===null||w===void 0?void 0:w.others)===null||A===void 0)&&A.multiple){const B=Object.keys(i[r[0]]),I=Object.entries(r[1].children).map(k=>Object.keys(i[r[0]]).includes(k[0])?[k[0],i[r[0]][k[0]]]:[k[0],k[1].defaultValue]);return[...n,[r[0],Object.assign(Object.assign({},r[1]),{value:e(r[1].children,Object.fromEntries(I)),optionsValue:B})]]}return[...n,[r[0],Object.assign(Object.assign({},r[1]),{value:e(r[1].children,i[r[0]])})]]}return i[r[0]]!==void 0?(console.log(i[r[0]]),[...n,[r[0],Object.assign(Object.assign({},r[1]),{value:i[r[0]].toString()})]]):[...n]},[]);return Object.fromEntries(q)};return e(l,t)},V=l=>{const t=JSON.parse(JSON.stringify(l));for(let e in t)if(t[e].children)if(t[e].isArray&&Array.isArray(t[e].value)){const f=t[e].value.map(o=>V(o));t[e]=f}else{const f=V(t[e].value);t[e]=f}else t[e].value?Number.isNaN(Number(t[e].value))?t[e].value==="true"||t[e].value==="false"?t[e]=JSON.parse(t[e].value):t[e]=t[e].value:t[e]=new Number(t[e].value):delete t[e];return t},b=(l,t=!1)=>{var e,f;for(let o in l)if(l[o].children){const i=b(l[o].children,t);l[o].isArray&&(l[o]=Object.assign(Object.assign({},l[o]),{value:[i]})),l[o]=Object.assign(Object.assign({},l[o]),{value:i})}else{const i=((e=l[o].others)===null||e===void 0?void 0:e.defaultValue)||"";t&&((f=l[o].others)===null||f===void 0?void 0:f.isOnce)?delete l[o]:l[o]=Object.assign(Object.assign({},l[o]),{value:i})}return l},m=l=>{let t=!1;l.value.length>=1&&(t=!0);const e=b(JSON.parse(JSON.stringify(l.children)),t);l!=null&&l.value||(l.value=[]),l.value.push(e)},R=(l,t)=>{const e=JSON.parse(JSON.stringify(l));e.value.splice(t,1),l.value=[],P(()=>{l.value=e.value})},j=(l,t,e,f)=>{if(e!=null&&e.children){const o=Object.entries(f).filter(i=>l.includes(i[0]));p=e.value=Object.fromEntries(o)||{};return}if(t!=null&&t.optionRelations){const o=Object.entries(t.optionRelations.descRules).find(i=>i[0]===l);Array.isArray(o)&&o.length===2&&(d.renderData[t.optionRelations.target].desc=o[1])}};return M(d.renderData,l=>{s("update:renderData",l)},{deep:!0}),c({initData:x,parseToYaml:V}),(l,t)=>{const e=v("el-col"),f=v("el-form-item"),o=v("el-button"),i=v("yamlEdit"),S=v("el-icon"),q=v("el-form");return u(),O("div",ee,[(u(!0),O(N,null,$(a.renderData,(n,r)=>(u(),h(q,{"label-position":"right","label-width":a.labelWidth,key:r},{default:y(()=>[n.children?_("v-if",!0):(u(),h(f,{key:0,label:n.desc},{default:y(()=>[D(e,{span:24},{default:y(()=>[D(F,{disabled:!a.isEdit,type:n.type,renderData:n.others,modelValue:n.value,"onUpdate:modelValue":g=>n.value=g,onSelectChange:j},null,8,["disabled","type","renderData","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["label"])),_(" \u914D\u7F6E\u9879\u5B9A\u4E49\u591A\u9009start "),n.others&&n.others.multiple?(u(),h(f,{key:1,label:n.desc},{default:y(()=>[D(e,{span:24},{default:y(()=>[D(F,{disabled:!a.isEdit,type:n.type,renderData:n.others,detailVal:n,modelValue:n.optionsValue,"onUpdate:modelValue":g=>n.optionsValue=g,onSelectChange:j},null,8,["disabled","type","renderData","detailVal","modelValue","onUpdate:modelValue"])]),_:2},1024),_(` <el-col v-if="value.others && value.others.multiple">\r
          <yamlEdit\r
            :renderData="multiShowData"\r
            :isEdit="false"\r
            :label-width="labelWidth"\r
          />\r
        </el-col> `)]),_:2},1032,["label"])):_("v-if",!0),_(" && !(value.others && value.others.multiple) "),_(" \u914D\u7F6E\u9879\u5B9A\u4E49\u591A\u9009end "),n.children?(u(),h(f,{key:2,label:n.others&&n.others.multiple?"":n.desc},{default:y(()=>[n.isArray&&a.isEdit?(u(),h(e,{key:0,style:{"margin-bottom":"10px"}},{default:y(()=>[D(o,{icon:E(G),onClick:g=>m(n)},{default:y(()=>[z("\u65B0\u589E"+L(n.desc),1)]),_:2},1032,["icon","onClick"])]),_:2},1024)):_("v-if",!0),n.isArray?(u(),O(N,{key:2},[_(" \u6570\u7EC4\u7C7B\u578B "),(u(!0),O(N,null,$(n.value,(g,w)=>(u(),h(e,{key:w,style:{border:"1px solid #ccc","margin-bottom":"10px"}},{default:y(()=>[W("div",le,[a.isEdit?(u(),h(S,{key:0,onClick:A=>R(n,w)},{default:y(()=>[D(E(K))]),_:2},1032,["onClick"])):_("v-if",!0),D(i,{renderData:g,"label-width":a.labelWidth},null,8,["renderData","label-width"])])]),_:2},1024))),128))],2112)):(u(),h(e,{key:1,style:{border:"1px solid #aaa","margin-bottom":"10px"}},{default:y(()=>[W("div",te,[n.others&&n.others.multiple?(u(),h(i,{key:0,renderData:E(p),"label-width":a.labelWidth},null,8,["renderData","label-width"])):(u(),h(i,{key:1,renderData:n.value,"label-width":a.labelWidth},null,8,["renderData","label-width"]))])]),_:2},1024))]),_:2},1032,["label"])):_("v-if",!0)]),_:2},1032,["label-width"]))),128))])}}}));function ae(a,c){c===void 0&&(c={});var s=c.insertAt;if(!(!a||typeof document=="undefined")){var d=document.head||document.getElementsByTagName("head")[0],p=document.createElement("style");p.type="text/css",s==="top"&&d.firstChild?d.insertBefore(p,d.firstChild):d.appendChild(p),p.styleSheet?p.styleSheet.cssText=a:p.appendChild(document.createTextNode(a))}}var re=`.yamlEdit {
  padding: 10px;
}
.yamlEdit .el-form-item .el-form-item__label {
  white-space: nowrap;
}
.yamlEdit .el-form-item .el-form-item {
  margin-bottom: 22px;
  white-space: nowrap;
}`;ae(re);C.__file="packages/yaml-edit/src/index.vue";C.install=a=>{a.component(C.name,C)};const se=J({components:{YamlEdit:C},setup(){const a=T({}),c=T(),s={enable:{type:"switch",desc:"\u603B\u5F00\u5173"},resourceDef:{desc:"resourceDef",children:{outAdaptors:{type:"input",desc:"outAdaptors",children:{nioHttpOutAdaptor:{isArray:!0,desc:"nioHttpOutAdaptor",children:{resourceExpr:{type:"input",desc:"resourceExpr"},usageType:{type:"input",desc:"usageType"}}}}}}},rules:{isArray:!0,desc:"",children:{resource:{type:"input",desc:"resource"},enable:{type:"input",desc:"enable"},grade:{type:"select",desc:"grade",others:{options:[{label:"\u6162\u8C03\u7528\u6BD4\u4F8B",value:"0"},{label:"\u5F02\u5E38\u6BD4\u4F8B",value:"1"},{label:"\u5F02\u5E38\u6570",value:"2"}]}},timeWindow:{type:"input",desc:"timeWindow"},count:{type:"input",desc:"count"},minRequestAmount:{type:"input",desc:"minRequestAmount"},slowRatioThreshold:{type:"input",desc:"slowRatioThreshold"},statIntervalMs:{type:"input",desc:"statIntervalMs"}}}},d={enable:!0,resourceDef:{outAdaptors:{nioHttpOutAdaptor:[{resourceExpr:"/out/${serviceCode}"},{resourceExpr:"/out/http/${__rf.host}:${__rf.varPort}/${serviceCode}",usageType:"SND_RCV"}]}},rules:[{resource:"/out/test",enable:!0,grade:0,timeWindow:10,count:1e3,minRequestAmount:1,slowRatioThreshold:.6,statIntervalMs:1e4}]};return X(()=>{a.value=E(c).initData(s,d)}),{combineData:a,clYamlEditRef:c}}}),oe={class:"wrapper"},ie=W("h3",null,"example from yamlEdit:",-1);function de(a,c,s,d,p,x){const V=v("yamlEdit");return u(),O("div",oe,[ie,D(V,{renderData:a.combineData,labelWidth:"120px",ref:"clYamlEditRef"},null,8,["renderData"])])}var ce=Q(se,[["render",de]]);export{ce as default};
